# PowerJob çš„è‡ªå®žçŽ°é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå¦™å¦™å¦™ï¼
> æœ¬æ–‡é€‚åˆæœ‰ Java åŸºç¡€çŸ¥è¯†çš„äººç¾¤

![](../cover.png)

ä½œè€…ï¼šHelloGitHub-**Salieri**

HelloGitHub æŽ¨å‡ºçš„[ã€Šè®²è§£å¼€æºé¡¹ç›®ã€‹](https://github.com/HelloGitHub-Team/Article)ç³»åˆ—ã€‚

## ç¢Žç¢Žå¿µ

é«˜å¯ç”¨æ”¾åˆ°ä»Šå¤©å·²ç»ä¸æ˜¯ä¸€ä¸ªæ–°é¢–çš„è¯æ±‡äº†ï¼Œæ€Žä¹ˆå®žçŽ°é«˜å¯ç”¨å¤§å®¶ä¹Ÿå·²ç»äº†ç„¶äºŽå¿ƒã€‚å¤šå®žä¾‹éƒ¨ç½² + æœåŠ¡æ³¨å†Œ + æœåŠ¡å‘çŽ°è¿™ä¸€å¥—ç»„åˆæ‹³æ‰“ä¸‹æ¥ï¼Œå®žçŽ°é«˜å¯ç”¨é‚£è¿˜ä¸æ˜¯åˆ†åˆ†é’Ÿçš„äº‹æƒ…ã€‚æ‰€ä»¥å¾ˆå¤šäººçœ‹åˆ° PowerJob çš„ä»‹ç»é¡µé¢ä¸­å†™äº†**ä»»æ„ç»„ä»¶æ”¯æŒé›†ç¾¤éƒ¨ç½²ä»¥å®žçŽ°é«˜å¯ç”¨**ï¼Œæƒ³å½“ç„¶çš„ä»¥ä¸ºä¹Ÿæ˜¯èµ°äº†ä¸Šè¿°çš„é‚£å¥—æµç¨‹ã€‚ç„¶åŽçœ‹åˆ°ç³»ç»Ÿä¾èµ–ç»„ä»¶æ—¶ï¼Œå‘çŽ°......emmm...... Zookeeper å‘¢ï¼Ÿæ²¡çœ‹ç€ã€‚é‚£æ‰¾æ‰¾ Nacos ï¼Ÿemmm......ä¹Ÿæ²¡æ‰¾ç€......ä¸ä»…æ²¡æ‰¾ç€ï¼Œè¿˜å‘çŽ°æ–‡æ¡£ä¸­æ˜Žæ˜Žç™½ç™½çš„å†™ç€ï¼Œ**æœ€å°ä¾èµ–ä»…ä¸ºå…³ç³»åž‹æ•°æ®åº“**ã€‚è®¸å¤šç”¨æˆ·çœ‹åˆ°è¿™é‡Œå°±æœ‰ç‚¹ç™¾æ€ä¸å¾—å…¶è§£äº†ï¼Œæ­£å¸¸æ¥è®²éƒ½ä¼šæœ‰ä¸¤ä¸ªç–‘æƒ‘ã€‚

![](1.png)

é¦–å…ˆï¼Œä¸ºä»€ä¹ˆä¸ç”¨æ³¨å†Œä¸­å¿ƒå‘¢ï¼Ÿ

è¦åšåˆ°åˆ†å¸ƒå¼çŽ¯å¢ƒä¸‹çš„é«˜å¯ç”¨ï¼Œè‚¯å®šæ˜¯éœ€è¦æœåŠ¡æ³¨å†Œã€æœåŠ¡å‘çŽ°è¿™æ ·çš„æ¦‚å¿µçš„ã€‚æ²¡æœ‰å¤–éƒ¨æ³¨å†Œä¸­å¿ƒï¼Œè¯´ç™½äº†å°±æ˜¯è‡ªå·±åŽ»å®žçŽ°äº†ä¸€å¥—ç±»ä¼¼çš„æœºåˆ¶ã€‚é‚£ä¸ºä»€ä¹ˆè¦æ€Žä¹ˆåšå‘¢ï¼Ÿ

å…¶å®žç­”æ¡ˆå¾ˆç®€å•â€”â€”æˆæœ¬ã€‚è¿™ä¸ªæˆæœ¬æŒ‡çš„æ˜¯ç”¨æˆ·çš„æŽ¥å…¥æˆæœ¬ã€‚å¯¹äºŽä¸€ä¸ªéœ€è¦éƒ¨ç½²çš„é‡åž‹å¼€æºé¡¹ç›®æ¥è¯´ï¼Œæ¯å°‘ä¸€ä¸ªå¤–éƒ¨ä¾èµ–ï¼Œå°±å¤šä¸€ä»½æ½œåœ¨çš„ç”¨æˆ·ã€‚é¢å¤–çš„ç³»ç»Ÿä¾èµ–ä»£è¡¨ç€é¢å¤–çš„æŠ€æœ¯æ ˆå’Œé¢å¤–çš„ç»´æŠ¤æˆæœ¬ï¼Œå¦‚æžœä¼ä¸šæœ¬èº«æ²¡æœ‰è¿™ä¸€å¥—æŠ€æœ¯ä½“ç³»ï¼ˆæ¯”å¦‚æ²¡ç”¨åˆ° zookeeperï¼‰ï¼Œè€Œ PowerJob åˆå¼ºä¾èµ– zookeeperï¼Œé‚£å¤§æ¦‚çŽ‡åªèƒ½è¯´å†è§å–½ï½ž

ç¬¬ä¸€ä¸ªé—®é¢˜è§£å†³äº†ï¼ŒæŽ¥ä¸‹æ¥è¿›å…¥ç¬¬äºŒä¸ªé—®é¢˜ï½ž

![](2.png)

## ç®€å•é«˜â€œå¯ç”¨â€

PowerJob ç³»ç»Ÿä¸­çš„åŸºç¡€ç»„ä»¶ä¸ºè°ƒåº¦æœåŠ¡å™¨ server å’Œæ‰§è¡Œå™¨ workerï¼Œserver è´Ÿè´£è°ƒåº¦å®šæ—¶ä»»åŠ¡ï¼Œå¹¶æ´¾å‘åˆ° worker æ‰§è¡Œï¼Œæ˜¯ä¸€ä¸ªå…¸åž‹çš„ C/S æž¶æž„ã€‚

C/S æž¶æž„ä¸‹ï¼Œå¦‚æžœç›®æ ‡æ˜¯ server å’Œ client å¯ä»¥ç›¸äº’è”é€šçš„â€œé«˜å¯ç”¨â€ï¼Œé‚£ä¹ˆå®žçŽ°èµ·æ¥å…¶å®žéžå¸¸å®¹æ˜“ã€‚

é¦–å…ˆï¼Œå¯åŠ¨å¤šä¸ª server åº”ç”¨å®žä¾‹ï¼Œé›†ç¾¤éƒ¨ç½²ã€‚ç„¶åŽå°†å¤šä¸ª server çš„ IP åœ°å€ç»Ÿç»Ÿå¡«å…¥ worker çš„é…ç½®æ–‡ä»¶ä¸­ï¼Œworker å¯åŠ¨æ—¶ï¼Œéšæœºæ‰¾ä¸€ä¸ª IP è¿›è¡Œè¿žæŽ¥ï¼Œå¤±è´¥åˆ™é‡è¯•ã€‚ä¸€æ—¦æˆåŠŸè¿žæŽ¥åˆ°æŸä¸€å° serverï¼Œå°±å¼€å§‹ä¸ŠæŠ¥è‡ªå·±çš„åœ°å€ä¿¡æ¯ã€‚server é€šè¿‡æŒæœ‰è¿™ä¸ªä¿¡æ¯ä¹Ÿå¯ä»¥å’Œ worker è¿›è¡Œé€šè®¯ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œä¸€ä¸ªæœ€ç®€å•ç‰ˆæœ¬çš„â€œé«˜å¯ç”¨â€é›†ç¾¤å°±æ­å»ºå®Œæˆäº†ã€‚ä½†æ˜¯......å®ƒçœŸçš„å¯ç”¨å—ï¼Ÿ

![](3.png)

ç­”æ¡ˆæ˜¾ç„¶æ˜¯å¦å®šçš„ï¼ˆå¦åˆ™ä¹Ÿä¸ä¼šæœ‰è¿™ç¯‡æ–‡ç« äº†æ˜¯ä¸æ˜¯ï½žï¼‰ã€‚ä»¥ä¸Šæ–¹æ¡ˆä¸»è¦å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š

1. ä»»åŠ¡è°ƒåº¦éœ€è¦ä¿è¯å”¯ä¸€æ€§ï¼Œå³æŸä¸ªä»»åŠ¡åœ¨æŸä¸€ä¸ªæ—¶åˆ»åªèƒ½è¢«ä¸€å°æœºå™¨è°ƒåº¦ï¼Œå¦åˆ™å°±ä¼šå¯¼è‡´é‡å¤æ‰§è¡Œã€‚è€Œå‰æ–‡æåŠçš„æ–¹æ¡ˆä¸­ï¼Œæ¯ä¸€å° server éƒ½æ˜¯å®Œå…¨ç­‰ä»·çš„ï¼Œå› æ­¤åªèƒ½ä¾é åˆ†å¸ƒå¼é”æ¥ä¿è¯å”¯ä¸€æ€§ï¼Œå³æŠ¢åˆ°é”çš„ server æ‰§è¡Œè°ƒåº¦ï¼Œå…¶ä»– server åªèƒ½å……å½“æˆ˜åœ°è®°è€…ï¼Œé»˜é»˜åœ°è¾¹ç¼˜ OBã€‚è¿™ç§æ–¹æ¡ˆä¸‹ï¼Œæ— è®ºéƒ¨ç½²å¤šå°‘å° serverï¼Œç³»ç»Ÿæ•´ä½“çš„è°ƒåº¦æ€§èƒ½å…¶å®žæ˜¯å›ºå®šçš„ï¼Œå¤šå®žä¾‹éƒ¨ç½²åªèƒ½åšåˆ°é«˜å¯ç”¨ï¼Œè€Œä¸èƒ½åšåˆ°é«˜æ€§èƒ½ã€‚
2. server æ— æ³•æŒæœ‰å®Œæ•´çš„ worker é›†ç¾¤ä¿¡æ¯ã€‚PowerJob çš„å®šä½æ˜¯**ä»»åŠ¡è°ƒåº¦ä¸­é—´ä»¶**ï¼Œæ—¨åœ¨ä¸ºä¼ä¸šä¸‹å„éƒ¨é—¨å„ä¸šåŠ¡çº¿æä¾›ç²¾å‡†çš„è°ƒåº¦å’Œåˆ†å¸ƒå¼è®¡ç®—èƒ½åŠ›ã€‚å› æ­¤è‚¯å®šä¼šæœ‰é›†ç¾¤åˆ†ç»„çš„æ¦‚å¿µï¼Œå°±åƒ RocketMQ ä¸­å­˜åœ¨ ProducerGroup å’Œ ConsumerGroup ä¸€æ ·ï¼ŒPowerJob æœ‰ç€ AppName çš„æ¦‚å¿µã€‚ä¸€ä¸ª AppName é€»è¾‘ä¸Šå¯¹åº”äº†æŸä¸ªåº”ç”¨ä¸‹çš„ä¸€ç»„ä»»åŠ¡ï¼Œç‰©ç†ä¸Šå¯¹åº”äº†è¿™ä¸ªåº”ç”¨æ‰€éƒ¨ç½²çš„é›†ç¾¤ã€‚ä¸ºäº†ä¾¿äºŽ server ç»Ÿä¸€ç®¡ç†ä»¥åŠä¸€äº›é¢å¤–åŠŸèƒ½çš„å®žçŽ°ï¼ˆåˆ†å¸ƒå¼è®¡ç®—ï¼‰ï¼Œserver æŒæœ‰æŸä¸€ä¸ª AppName ä¸‹å®Œæ•´çš„é›†ç¾¤ä¿¡æ¯æ˜¯ä¸€ä¸ªå¼ºè¯‰æ±‚ï¼Œè€Œå‰æ–‡æåŠçš„â€œçžŽçŒ«æ’žä¸Šæ­»è€—å­â€å¼æ–¹æ¡ˆï¼Œæ˜¾ç„¶æ²¡åŠžæ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚

åŸºäºŽä»¥ä¸Šä¸¤ç‚¹ï¼Œå¾é€”æ˜¯æ˜Ÿè¾°å¤§æµ·çš„ PowerJob éœ€è¦æŽ¢ç´¢å‡ºä¸€ç§æ›´åˆç†ã€æ›´å¼ºå¤§çš„é«˜å¯ç”¨æž¶æž„ã€‚

## åˆ†ç»„éš”ç¦»

å…¶å®žæ ¹æ®å‰é¢é‡åˆ°çš„é—®é¢˜ï¼Œè¿™ä¸€å¥—æœºåˆ¶çš„é›å½¢ä¹Ÿå·®ä¸å¤šå‡ºæ¥äº†ã€‚

server æ—¢ç„¶éœ€è¦æŒæœ‰æŸä¸€ä¸ªåˆ†ç»„ä¸‹å®Œæ•´çš„é›†ç¾¤ä¿¡æ¯ï¼Œé‚£ä¹ˆå¯ä»¥é¡ºå…¶è‡ªç„¶çš„æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½è®©æŸä¸€ä¸ªåˆ†ç»„çš„æ‰€æœ‰ worker éƒ½è¿žæŽ¥åˆ°æŸä¸€å° server å‘¢ï¼Ÿä¸€æ—¦æŸä¸ªåˆ†ç»„ä¸‹æ‰€æœ‰æœºå™¨å…¨éƒ¨è¿žæŽ¥åˆ°äº†æŸä¸€å° serverï¼Œé‚£ä¹ˆå…¶å®žè¿™å°±å½¢æˆäº†ä¸€ä¸ªå°åž‹çš„å­ç³»ç»Ÿã€‚è™½ç„¶æ•´ä¸ª PowerJob ç³»ç»Ÿä¸­å­˜åœ¨ç€å¤šå° server å’Œå¤šä¸ª worker é›†ç¾¤ï¼Œä½†æ˜¯å¯¹äºŽè¿™ä¸ªåˆ†ç»„çš„è¿è¡Œæ¥è¯´ï¼Œåªè¦æœ‰è¿™ä¸ªåˆ†ç»„å¯¹åº”çš„ worker é›†ç¾¤ä»¥åŠå®ƒä»¬è¿žæŽ¥çš„é‚£ä¸€å° server å°±å¤Ÿäº†ã€‚é‚£ä¹ˆåœ¨è¿™ä¸ªå°åž‹â€œå­ç³»ç»Ÿâ€å†…éƒ¨ï¼Œåªå­˜åœ¨ç€ä¸€å° serverï¼Œä¹Ÿå°±ä¸å­˜åœ¨é‡å¤è°ƒåº¦é—®é¢˜äº†ï¼ˆserver åªè°ƒåº¦è¿žæŽ¥åˆ°å®ƒçš„ AppName ä¸‹é¢çš„ä»»åŠ¡å°±èƒ½å®žçŽ°è¿™ä¸€ç‚¹ï¼‰ã€‚

æ‰€ä»¥ï¼Œç»è¿‡ä¸€å±‚å±‚çš„å‰¥ä¸æŠ½èŒ§ï¼Œé—®é¢˜å·²ç»è½¬åŒ–ä¸ºäº†ï¼š**å¦‚ä½•è®©æŸä¸ªåˆ†ç»„ä¸‹çš„æ‰€æœ‰æœºå™¨éƒ½è¿žæŽ¥åˆ°åŒä¸€å° server ä¸ŠåŽ»å‘¢ï¼Ÿ**

çœ‹åˆ°è¿™ä¸ªé—®é¢˜çš„æ—¶å€™ï¼Œç›¸ä¿¡å¾ˆå¤šäººä¼šæœ‰å’Œæˆ‘å½“æ—¶ä¸€æ ·çš„æƒ³æ³•ï¼Œé‚£å°±æ˜¯ï¼šå°±è¿™ï¼Ÿ

![](4.png)

â€œè®©æ‰€æœ‰æœºå™¨éƒ½è¿žæŽ¥åˆ°åŒä¸€å° server ä¸ŠåŽ»ï¼Œé‚£ä¹Ÿå¤ªç®€å•äº†å§ï¼Œä½ åªé…ç½®ä¸€ä¸ª IP ä¸å°±è¡Œäº†å—ï¼Ÿâ€

â€œé…ç½®ä¸€ä¸ª IP æ€Žä¹ˆåšé«˜å¯ç”¨ï¼Œæ€Žä¹ˆåˆ©ç”¨å¤šå° server èµ„æºï¼Ÿâ€

â€œðŸ¤”å¥½åƒæœ‰ç‚¹é“ç†ï¼Œé‚£å°± hash(appName) å–ä½™ä½œä¸ºä¸‹æ ‡ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åŒä¸€ä¸ªåŒä¸€ä¸ªåˆ†ç»„ä¸‹æ‰€æœ‰æœºå™¨çš„åˆå§‹ IP ç›¸åŒï¼Œä¸åŒåˆ†ç»„ä¹Ÿèƒ½è¿žæŽ¥åˆ°ä¸åŒçš„ serverâ€

â€œé‚£ï¼Œä¸‡ä¸€è¿žæŽ¥çš„ server æŒ‚äº†æ€Žä¹ˆåŠžï¼Ÿâ€

â€œè¿™å¥½åŠžï¼Œå¯ä»¥é‡‡å–ç±»ä¼¼äºŽè§£å†³å“ˆå¸Œå†²çªçš„é‚£ä¸ªä»€ä¹ˆå¼€æ”¾å®šå€æ³•ï¼Œä»ŽæŒ‚æŽ‰çš„ server ä¸‹æ ‡å¼€å§‹ï¼Œä¾æ¬¡å‘åŽé‡è¯•å°±è¡Œäº†ï¼ŒåŒä¸€ä¸ªåˆ†ç»„é›†ç¾¤å†…æ‰€æœ‰çš„æœºå™¨éƒ½ä»ŽæŸä¸ªä¸‹æ ‡ä¾æ¬¡å‘åŽé‡è¯•ï¼Œè¿˜æ˜¯èƒ½è¿žæŽ¥åˆ°åŒä¸€å° server çš„â€

â€œðŸ¤”å¥½åƒå¾ˆæœ‰é“ç†ï¼Œå“¼ï¼Œworker é€‰ä¸»ä¹Ÿå°±ä¸è¿‡å¦‚æ­¤ï¼Œæ–¹æ¡ˆæžå®šï¼Œè‹±é›„è”ç›Ÿ å¯åŠ¨ï¼â€


æ­£å½“æˆ‘æµ´è¡€å¥‹æˆ˜ç›´æŒ‡æ•Œå°†é¦–çº§æ—¶ï¼Œç”»é¢...æ°¸è¿œå®šæ ¼åœ¨äº†è§è¡€å‰çš„é‚£ä¸€çž¬ã€‚â€œæ­£åœ¨å°è¯•é‡æ–°è¿žæŽ¥â€å‡ ä¸ªå¤§å­—æ˜ å…¥çœ¼å¸˜ï¼Œä¹ŸæŠŠæˆ‘å¸¦å…¥äº†æ·±æ·±çš„æ²‰æ€ã€‚

![](5.png)

è™½è¯´æ¯æ¬¡çŽ©æ¸¸æˆå¿…éª‚è…¾è®¯é‚£***çš„åœŸè±†æœåŠ¡å™¨ï¼Œä½†éª‚å½’éª‚ï¼Œå¿ƒé‡Œå…¶å®žè¿˜æ˜¯æ˜Žç™½ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯è‡ªå·±ç½‘ç»œæ³¢åŠ¨å¯¼è‡´æ¸¸æˆæŽ‰çº¿ï¼ˆ~~è°å«æˆ‘è´ªä¾¿å®œåŠžäº†ä¸ªç§»åŠ¨å®½å¸¦å‘¢ï¼Œå“Žï¼Œé›·ç”µæ³•çŽ‹æ¨æ°¸ä¿¡ä¹Ÿå°±å›¾ä¸€ä¹ï¼ŒçœŸè¦æˆ’ç½‘ç˜¾è¿˜å¾—çœ‹ç§»åŠ¨å®½å¸¦~~ï¼‰ã€‚

å—¯ï¼Ÿè‡ªå·±çš„åŽŸå› ï¼Ÿç½‘ç»œæ³¢åŠ¨ï¼ŸæŽ‰çº¿ï¼Ÿé‡è¿žï¼Ÿè¿™ä¸€è¿žä¸²è¯æ±‡ï¼ŒæŠŠæˆ‘æ‹‰å›žäº†åˆšåˆšè®¾è®¡çš„æ–¹æ¡ˆä¹‹ä¸­ï¼Œç„¶åŽç»™æˆ‘å½“å¤´ä¸€æ£’ã€‚ä¸€æ—¦ worker å› ä¸ºè‡ªå·±çš„ç½‘ç»œæ³¢åŠ¨å¯¼è‡´å®ƒä»¥ä¸º server ä¸å¯ç”¨ï¼Œè€Œé‡æ–°è¿žæŽ¥å¦ä¸€å° serverï¼Œå°±ä¼šå¯¼è‡´æ‰€æœ‰ worker éƒ½è¿žæŽ¥åŒä¸€å° server è¿™ä¸ªçº¦æŸè¢«ç ´å......å› æ­¤ï¼Œè¿™ä¸ªæ–¹æ¡ˆè‡ªç„¶ä¹Ÿå°±æ˜¯ä¸€ä¸ªå……æ»¡æ¼æ´žçš„ä¸å¯è¡Œæ–¹æ¡ˆã€‚

![](6.png)

åœ¨è¿™ä¹‹åŽçš„ä¸€å‘¨ï¼Œå¯ä»¥è¯´æ˜¯æ”¯ç¦»ç ´ç¢Žçš„ä¸€å‘¨ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘è®¾è®¡äº†æ— æ•°ä¸ªå ªç§°â€œå¥‡çå¼‚å…½â€çš„æ–¹æ¡ˆï¼Œç„¶åŽå†ä¸€ä¸ªä¸ªå¦å®šå’Œæžªæ¯™ã€‚

å…¶å®žè¿™æ®µç»åŽ†çŽ°åœ¨å›žè¿‡å¤´æ¥æƒ³ç‰¹åˆ«æžç¬‘ï¼Œä¹Ÿæœ‰è¢«è‡ªå·±è ¢åˆ°ã€‚é‚£æ— æ•°ä¸ªæ–¹æ¡ˆçš„å¤±è´¥åŽŸå› å…¶å®žéƒ½æ˜¯åŒä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯**å‡ºå‘ç‚¹é”™äº†**ã€‚æˆ‘ä¸€ç›´åœ¨å°è¯•è®© worker å†³å®šè¿žæŽ¥å“ªå° serverï¼Œå´ä¸€è€Œå†å†è€Œä¸‰å¿½ç•¥ worker æ°¸è¿œä¸å¯èƒ½èŽ·å– server çœŸæ­£çš„å­˜æ´»ä¿¡æ¯ï¼ˆæ¯”å¦‚å¿ƒè·³æ— æ³•ä¼ è¾¾ï¼Œå¯èƒ½æ˜¯ worker æœ¬èº«çš„ç½‘ç»œæ•…éšœï¼‰ï¼Œå› æ­¤ **worker ä¸åº”è¯¥å†³å®šè¿žæŽ¥å“ªå° serverï¼Œè¿™åº”è¯¥ç”± server æ¥å†³å®šã€‚worker èƒ½åšçš„ï¼Œåªæœ‰æœåŠ¡å‘çŽ°**ã€‚æƒ³æ˜Žç™½äº†è¿™ç‚¹ï¼Œå…·ä½“çš„æ–¹æ¡ˆä¹Ÿå°±åº”è¿è€Œç”Ÿäº†ã€‚

PSï¼šè¿™ä¸ªæ–¹æ¡ˆçš„è¯žç”Ÿï¼Œæˆ‘å¤§æ¦‚ä»˜å‡ºäº†1æ–¤è„‘ç»†èƒžçš„ä»£ä»·ï¼ˆä¸å¾—ä¸è¯´è¿™ä¸ªå‡è‚¥æ–¹æ³•è¿˜è›®å¥½çš„ï¼‰...è„‘ç»†èƒžä¸èƒ½ç™½æ­»ï¼Œå°½ç®¡é‚£äº›å¥‡å¥‡æ€ªæ€ªå¾—æ–¹æ¡ˆæ²¡æœ‰æ´»åˆ°æ­£å¼ç‰ˆæœ¬ï¼Œä½†æ²¡æœ‰ä»–ä»¬å°±æ— æ³•é€šå¾€çœŸç†çš„å¤§é—¨ã€‚ä¸ºäº†è¡¨è¾¾çºªå¿µå’Œâ€œå“€æ‚¼â€ä¹‹æƒ…ï¼Œæˆ‘å°†æœ€ç»ˆçš„è®¾è®¡å‘½åä¸ºâ€”â€”V4ï¼šä¸§é’Ÿä¸ºè°é¸£ã€‚

![](7.png)

## V4ï¼šä¸§é’Ÿä¸ºè°é¸£

> æƒ³æ˜Žç™½äº†ä¸èƒ½ç”± Worker å‘èµ· Server çš„é‡æ–°é€‰ä¸¾ï¼Œè¿™ä¸ªé—®é¢˜å°±åŸºæœ¬ä¸Šè§£å†³äº†......ç”±äºŽç¯‡å¹…åŽŸå› ä»¥åŠç½‘ä¸Šå·²ç»æœ‰å°ä¼™ä¼´å†™äº†è¿™ä¸€å—æºç åˆ†æžçš„åšå®¢ï¼Œæˆ‘è¿™é‡Œå°±ä¸é‡å¤â€œé€ è½®å­â€äº†ï¼Œåœ¨è¿™é‡Œä¸»è¦è®²ä¸€ä¸‹è®¾è®¡æ€è·¯ã€‚

å°±åƒå‰é¢è¯´çš„é‚£æ ·ï¼Œworker å› ä¸ºæ²¡åŠžæ³•èŽ·å– server çš„å‡†ç¡®çŠ¶æ€ï¼Œæ‰€ä»¥ä¸èƒ½ç”± worker æ¥å†³å®šè¿žæŽ¥å“ªä¸€å° serverã€‚å› æ­¤ï¼Œworker éœ€è¦åšçš„ï¼Œåªæ˜¯**æœåŠ¡å‘çŽ°**ã€‚å³å®šæ—¶ä½¿ç”¨ HTTP è¯·æ±‚ä»»æ„ä¸€å° serverï¼Œè¯·æ±‚èŽ·å–å½“å‰è¯¥åˆ†ç»„ï¼ˆappNameï¼‰å¯¹åº”çš„ serverã€‚

è€Œ server æ”¶åˆ°æ¥è‡ª worker çš„æœåŠ¡å‘çŽ°è¯·æ±‚åŽï¼Œå…¶å®žå°±æ˜¯è¿›è¡Œäº†ä¸€åœºå°åž‹çš„åˆ†å¸ƒå¼é€‰ä¸»ï¼šserver ä¾èµ–çš„æ•°æ®åº“ä¸­å­˜åœ¨ç€ server_info è¡¨ï¼Œå…¶ä¸­è®°å½•äº†æ¯ä¸€ä¸ªåˆ†ç»„ï¼ˆappNameï¼‰æ‰€å¯¹åº”çš„ server ä¿¡æ¯ã€‚å¦‚æžœè¯¥ server å‘çŽ°è¡¨ä¸­å­˜åœ¨è®°å½•ï¼Œé‚£å°±è¯´æ˜Žè¯¥ worker é›†ç¾¤ä¸­å·²ç»æœ‰åˆ«çš„ worker äº‹å…ˆè¯·æ±‚ server è¿›è¡Œé€‰ä¸¾ï¼Œé‚£ä¹ˆæ­¤æ—¶åªéœ€è¦å‘é€ PING è¯·æ±‚æ£€æµ‹è¯¥ server æ˜¯å¦å­˜æ´»ã€‚å¦‚æžœå‘çŽ°è¯¥ server å­˜æ´»ï¼Œé‚£ä¹ˆç›´æŽ¥è¿”å›žè¯¥ server çš„ä¿¡æ¯ä½œä¸ºè¯¥åˆ†ç»„çš„ serverã€‚å¦åˆ™å°±å®Œæˆç¯¡ä½ï¼Œå°†è‡ªå·±çš„ä¿¡æ¯å†™å…¥æ•°æ®åº“è¡¨ä¸­ï¼Œæˆä¸ºè¯¥åˆ†ç»„çš„ serverã€‚

ç»†å¿ƒçš„å°ä¼™ä¼´å¯èƒ½åˆè¦é—®äº†ï¼Ÿå‘é€ PING è¯·æ±‚æ£€æµ‹è¯¥ server æ˜¯å¦å­˜æ´»ï¼Œä¸è¿˜æ˜¯æœ‰å’Œåˆšæ‰ä¸€æ ·çš„é—®é¢˜å—ï¼Ÿè¯·æ±‚ä¸åŒï¼Œå‘é€æ–¹å’ŒæŽ¥æ”¶æ–¹éƒ½æœ‰å¯èƒ½å‡ºé—®é¢˜ï¼Œå‡­ä»€ä¹ˆè®¤ä¸ºæ˜¯åŽŸå…ˆçš„ server æŒ‚äº†å‘¢ï¼Ÿ

ç¡®å®žï¼Œåœ¨è¿™ä¸ªæ–¹æ¡ˆä¸‹ï¼Œä¾æ—§æ²¡åŠžæ³•è§£å†³ server åˆ°åº•æŒ‚æ²¡æŒ‚è¿™ä¸ªå ªæ¯”â€œçœŸå‡ç¾ŽçŒ´çŽ‹â€çš„çŽ„å­¦é—®é¢˜ã€‚ä½†æ˜¯ï¼Œè¿™è¿˜é‡è¦å—ï¼Ÿæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æŸä¸ªåˆ†ç»„ä¸‹æ‰€æœ‰çš„ worker éƒ½è¿žæŽ¥åˆ°åŒä¸€å° serverï¼Œå› æ­¤ï¼Œå³ä¾¿äº§ç”Ÿé‚£ç§è¯¯æ‰“è¯¯æ’žç¯¡ä½çš„æƒ…å†µï¼Œåœ¨æœåŠ¡å‘çŽ°æœºåˆ¶çš„åŠ æŒä¸‹ï¼Œæ•´ä¸ªé›†ç¾¤æœ€ç»ˆè¿˜æ˜¯ä¼šè¿žæŽ¥åˆ°åŒä¸€å° serverï¼Œå®Œç¾Žå®žçŽ°æˆ‘ä»¬çš„éœ€æ±‚ã€‚

è‡³æ­¤ï¼Œè€—æ—¶ 6 å¤©ï¼Œä»ŽåŽŸæ¥çš„æ€€ç–‘äººç”Ÿï¼Œåˆ°å®Œç¾Žæ–¹æ¡ˆçš„è½åœ°å®žçŽ°ï¼ŒçœŸæ˜¯æ›²æŠ˜ï½ž

![](8.png)

## æœ€åŽ
æœ€åŽï¼Œè´´ä¸Šä¸¤ä½å°ä¼™ä¼´è´¡çŒ®çš„æºç åˆ†æžæ–‡ç« ï¼Œæˆ‘äº²è‡ª check è¿‡ï¼Œæ²¡æœ‰è´¨é‡é—®é¢˜ï¼ˆ~~è¿™è¯è¯´çš„æˆ‘æ„Ÿè§‰è‡ªå·±å¥½é£˜å“ˆå“ˆå“ˆ~~ï¼‰ï¼Œè¯·å„ä½è§‚ä¼—è€çˆ·æ”¾å¿ƒæŸ¥çœ‹ï½ž

- [PowerJobæºç åˆ†æž-åˆ†ç»„éš”ç¦»è®¾è®¡](https://zhuanlan.zhihu.com/p/163487886)

- [PowerJobæºç è§£è¯»1ï¼šServerå’ŒWorkerä¹‹é—´çš„é€šä¿¡è§£è¯»](https://juejin.im/post/6854573208524800008)

é‚£ä¹ˆä»¥ä¸Šå°±æ˜¯æœ¬ç¯‡æ–‡ç« å…¨éƒ¨çš„å†…å®¹äº†ï½žç›¸ä¿¡é€šè¿‡è¿™ç¯‡æ–‡ç« å’Œä¸Šç¯‡æ–‡ç« ï¼Œå¤§å®¶å·²ç»å¯¹ PowerJob çš„è°ƒåº¦å±‚å’Œé«˜å¯ç”¨é«˜æ€§èƒ½æž¶æž„æœ‰äº†ä¸€å®šçš„äº†è§£äº†ã€‚æŽ¥ä¸‹æ¥å°±æ˜¯ä¸‹æœŸé¢„å‘ŠçŽ¯èŠ‚äº†ï½ž

ä¸ºäº†ä¿ç•™ç¥žç§˜æ„Ÿï¼Œè¿™æ¬¡å°±é€‰æ‹©ä¸é¢„å‘Šäº†ï¼ˆ~~æ‰ä¸ä¼šå‘Šè¯‰ä½ æ˜¯æˆ‘è¿˜æ²¡æƒ³å¥½å…·ä½“å†™ä»€ä¹ˆ~~ï¼‰ï½ž

æ‰€æœ‰æƒŠå–œï¼Œä¸‹æœŸå†è§ï½ž

> é¡¹ç›®åœ°å€ï¼š
>
> https://github.com/KFCFans/PowerJob